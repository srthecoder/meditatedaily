<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meditation Habit Builder</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        h1 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 28px;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: #f7f9fc;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-number {
            font-size: 32px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 13px;
        }

        .growth-container {
            background: linear-gradient(to bottom, #87CEEB 0%, #98D8C8 100%);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            position: relative;
            min-height: 300px;
            overflow: hidden;
        }

        .ground {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: linear-gradient(to bottom, #8B7355 0%, #654321 100%);
            border-radius: 0 0 15px 15px;
        }

        .grass {
            position: absolute;
            bottom: 50px;
            left: 0;
            right: 0;
            height: 20px;
            background: linear-gradient(to bottom, #90EE90 0%, #228B22 100%);
        }

        .growth-stage {
            position: absolute;
            bottom: 70px;
            left: 50%;
            transform: translateX(-50%);
            transition: all 1s ease;
        }

        .seed {
            width: 20px;
            height: 20px;
            background: #8B4513;
            border-radius: 50%;
        }

        .sprout {
            width: 3px;
            height: 40px;
            background: #228B22;
            position: relative;
        }

        .sprout::before {
            content: 'üå±';
            position: absolute;
            top: -15px;
            left: -8px;
            font-size: 24px;
        }

        .small-tree {
            font-size: 50px;
        }

        .medium-tree {
            font-size: 80px;
        }

        .large-tree {
            font-size: 120px;
        }

        .forest {
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }

        .forest-tree {
            font-size: 60px;
            animation: sway 3s ease-in-out infinite;
        }

        .forest-tree:nth-child(2) {
            font-size: 80px;
            animation-delay: 0.5s;
        }

        .forest-tree:nth-child(3) {
            font-size: 70px;
            animation-delay: 1s;
        }

        @keyframes sway {
            0%, 100% { transform: rotate(-2deg); }
            50% { transform: rotate(2deg); }
        }

        .sun {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 40px;
            animation: shine 2s ease-in-out infinite;
        }

        @keyframes shine {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.1); }
        }

        .clouds {
            position: absolute;
            top: 30px;
            left: 20px;
            font-size: 30px;
            animation: float 20s linear infinite;
        }

        @keyframes float {
            0% { transform: translateX(-50px); }
            100% { transform: translateX(450px); }
        }

        .stage-label {
            text-align: center;
            margin-top: 15px;
            font-weight: bold;
            color: #2c5f2d;
            font-size: 18px;
        }

        .meditation-circle {
            width: 200px;
            height: 200px;
            margin: 30px auto;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .meditation-circle:hover {
            transform: scale(1.05);
        }

        .meditation-circle.breathing {
            animation: breathe 4s ease-in-out infinite;
        }

        @keyframes breathe {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .circle-content {
            color: white;
            text-align: center;
        }

        .timer {
            font-size: 48px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .timer-label {
            font-size: 14px;
            opacity: 0.9;
        }

        .duration-selector {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .duration-btn {
            padding: 10px 20px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .duration-btn:hover {
            background: #667eea;
            color: white;
        }

        .duration-btn.active {
            background: #667eea;
            color: white;
        }

        .control-btn {
            width: 100%;
            padding: 15px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
            transition: background 0.3s ease;
        }

        .control-btn:hover {
            background: #5568d3;
        }

        .control-btn.stop {
            background: #e74c3c;
        }

        .control-btn.stop:hover {
            background: #c0392b;
        }

        .instruction {
            text-align: center;
            color: #666;
            margin: 20px 0;
            font-size: 16px;
            font-style: italic;
        }

        .streak-container {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
            color: white;
            text-align: center;
        }

        .streak-number {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .motivation {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin-top: 20px;
            border-radius: 8px;
            color: #856404;
            font-size: 14px;
        }

        .reset-btn {
            background: #95a5a6;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            margin-top: 15px;
        }

        .reset-btn:hover {
            background: #7f8c8d;
        }

        .milestone-alert {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            z-index: 1000;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .milestone-alert.show {
            transform: translate(-50%, -50%) scale(1);
        }

        .milestone-alert h2 {
            color: #667eea;
            font-size: 32px;
            margin-bottom: 15px;
        }

        .milestone-icon {
            font-size: 80px;
            margin: 20px 0;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            display: none;
        }

        .overlay.show {
            display: block;
        }
    </style>
</head>
<body>
    <div class="overlay" id="overlay"></div>
    <div class="milestone-alert" id="milestoneAlert">
        <h2 id="milestoneTitle">üéâ Milestone Reached!</h2>
        <div class="milestone-icon" id="milestoneIcon">üå±</div>
        <p id="milestoneText">Your seed has sprouted!</p>
        <button class="control-btn" onclick="closeMilestone()" style="margin-top: 20px;">Continue Growing</button>
    </div>

    <div class="container">
        <h1>üßò Meditation Habit Builder</h1>
        <p class="subtitle">Watch your practice grow from seed to forest</p>

        <div class="stats">
            <div class="stat-card">
                <div class="stat-number" id="totalSessions">0</div>
                <div class="stat-label">Total Sessions</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalMinutes">0</div>
                <div class="stat-label">Minutes Meditated</div>
            </div>
        </div>

        <div class="growth-container">
            <div class="sun">‚òÄÔ∏è</div>
            <div class="clouds">‚òÅÔ∏è</div>
            <div class="growth-stage" id="growthStage">
                <div class="seed"></div>
            </div>
            <div class="grass"></div>
            <div class="ground"></div>
        </div>
        <div class="stage-label" id="stageLabel">Plant your seed (Day 1)</div>

        <div class="duration-selector">
            <button class="duration-btn active" data-duration="2">2 min</button>
            <button class="duration-btn" data-duration="5">5 min</button>
            <button class="duration-btn" data-duration="10">10 min</button>
        </div>

        <div class="meditation-circle" id="meditationCircle">
            <div class="circle-content">
                <div class="timer" id="timer">2:00</div>
                <div class="timer-label">Click to start</div>
            </div>
        </div>

        <div class="instruction" id="instruction">
            Start small. Just 2 minutes counts. You've got this.
        </div>

        <button class="control-btn" id="controlBtn" style="display: none;">Stop Session</button>

        <div class="streak-container">
            <div class="streak-number" id="streak">0</div>
            <div>Day Streak üî•</div>
        </div>

        <div class="motivation" id="motivation">
            üí° <strong>Habit Tip:</strong> Attach meditation to something you already do daily - like right after your morning coffee or before bed.
        </div>

        <button class="reset-btn" id="resetBtn">Reset All Progress</button>
    </div>

    <script>
        // Load data from memory
        let sessionData = {
            totalSessions: 0,
            totalMinutes: 0,
            streak: 0,
            lastSessionDate: null
        };

        // Try to load existing data
        const savedData = localStorage.getItem('meditationData');
        if (savedData) {
            sessionData = JSON.parse(savedData);
            updateDisplay();
            updateGrowthStage();
            checkStreak();
        }

        let selectedDuration = 2; // minutes
        let isRunning = false;
        let remainingSeconds = 120;
        let timerInterval = null;

        const circle = document.getElementById('meditationCircle');
        const timer = document.getElementById('timer');
        const instruction = document.getElementById('instruction');
        const controlBtn = document.getElementById('controlBtn');
        const durationBtns = document.querySelectorAll('.duration-btn');

        // Duration selection
        durationBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                if (!isRunning) {
                    durationBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    selectedDuration = parseInt(btn.dataset.duration);
                    remainingSeconds = selectedDuration * 60;
                    updateTimerDisplay();
                }
            });
        });

        // Start/Stop meditation
        circle.addEventListener('click', () => {
            if (!isRunning) {
                startMeditation();
            }
        });

        controlBtn.addEventListener('click', () => {
            stopMeditation(true);
        });

        function startMeditation() {
            isRunning = true;
            circle.classList.add('breathing');
            controlBtn.style.display = 'block';
            controlBtn.className = 'control-btn stop';
            
            const instructions = [
                "Breathe in slowly... hold... breathe out...",
                "Notice your breath. Let thoughts pass by.",
                "You're doing great. Just be present.",
                "Feel your body relaxing with each breath."
            ];
            
            let instructionIndex = 0;
            instruction.textContent = instructions[0];
            
            const instructionInterval = setInterval(() => {
                instructionIndex = (instructionIndex + 1) % instructions.length;
                instruction.textContent = instructions[instructionIndex];
            }, 10000);

            timerInterval = setInterval(() => {
                remainingSeconds--;
                updateTimerDisplay();
                
                if (remainingSeconds <= 0) {
                    clearInterval(instructionInterval);
                    stopMeditation(false);
                    completeSession();
                }
            }, 1000);
        }

        function stopMeditation(early) {
            isRunning = false;
            circle.classList.remove('breathing');
            controlBtn.style.display = 'none';
            clearInterval(timerInterval);
            
            if (early) {
                instruction.textContent = "No worries! Try again whenever you're ready.";
                remainingSeconds = selectedDuration * 60;
                updateTimerDisplay();
            }
        }

        function completeSession() {
            const oldStreak = sessionData.streak;
            sessionData.totalSessions++;
            sessionData.totalMinutes += selectedDuration;
            
            const today = new Date().toDateString();
            if (sessionData.lastSessionDate !== today) {
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate() - 1);
                
                if (sessionData.lastSessionDate === yesterday.toDateString()) {
                    sessionData.streak++;
                } else if (sessionData.lastSessionDate === null) {
                    sessionData.streak = 1;
                } else {
                    sessionData.streak = 1;
                }
                
                sessionData.lastSessionDate = today;
            }
            
            saveData();
            updateDisplay();
            updateGrowthStage();
            
            // Check for milestone
            checkMilestone(oldStreak, sessionData.streak);
            
            instruction.textContent = "üéâ Amazing! You did it! Same time tomorrow?";
            remainingSeconds = selectedDuration * 60;
            updateTimerDisplay();
            
            // Growth celebration
            const growthStage = document.getElementById('growthStage');
            growthStage.style.transform = 'translateX(-50%) scale(1.2)';
            setTimeout(() => {
                growthStage.style.transform = 'translateX(-50%) scale(1)';
            }, 500);
        }

        function updateGrowthStage() {
            const streak = sessionData.streak;
            const growthStage = document.getElementById('growthStage');
            const stageLabel = document.getElementById('stageLabel');
            
            if (streak === 0) {
                growthStage.innerHTML = '<div class="seed"></div>';
                stageLabel.textContent = 'Plant your seed (Day 1)';
            } else if (streak === 1) {
                growthStage.innerHTML = '<div class="sprout"></div>';
                stageLabel.textContent = 'üå± Sprout! (Day 1)';
            } else if (streak >= 2 && streak < 5) {
                growthStage.innerHTML = '<div class="small-tree">üåø</div>';
                stageLabel.textContent = `Small Plant (Day ${streak})`;
            } else if (streak >= 5 && streak < 10) {
                growthStage.innerHTML = '<div class="medium-tree">üå≥</div>';
                stageLabel.textContent = `Growing Tree! (Day ${streak})`;
            } else if (streak >= 10 && streak < 21) {
                growthStage.innerHTML = '<div class="large-tree">üå≤</div>';
                stageLabel.textContent = `Strong Tree (Day ${streak})`;
            } else if (streak >= 21) {
                growthStage.innerHTML = `
                    <div class="forest">
                        <div class="forest-tree">üå≤</div>
                        <div class="forest-tree">üå≥</div>
                        <div class="forest-tree">üå≤</div>
                    </div>
                `;
                stageLabel.textContent = `üå≤ Your Forest! (Day ${streak}) üå≤`;
            }
        }

        function checkMilestone(oldStreak, newStreak) {
            const milestones = [
                { day: 1, icon: 'üå±', title: 'First Sprout!', text: 'You planted the seed! Keep watering it daily.' },
                { day: 3, icon: 'üåø', title: 'Growing Strong!', text: '3 days! Your plant is establishing roots.' },
                { day: 5, icon: 'üå≥', title: 'First Tree!', text: '5 days straight! A tree is growing!' },
                { day: 7, icon: 'üéâ', title: 'One Week!', text: 'A full week of meditation. You\'re building something real.' },
                { day: 10, icon: 'üå≤', title: 'Strong & Tall!', text: '10 days! Your tree stands strong.' },
                { day: 14, icon: 'üí™', title: 'Two Weeks!', text: 'Half a month of consistency. Incredible!' },
                { day: 21, icon: 'üå≤üå≥üå≤', title: 'Forest Unlocked!', text: 'You\'ve built a forest! 21 days of habit formation.' },
                { day: 30, icon: 'üèÜ', title: 'One Month Master!', text: 'A full month! This is now part of who you are.' }
            ];

            const milestone = milestones.find(m => m.day === newStreak && newStreak > oldStreak);
            if (milestone) {
                showMilestone(milestone);
            }
        }

        function showMilestone(milestone) {
            document.getElementById('milestoneTitle').textContent = milestone.title;
            document.getElementById('milestoneIcon').textContent = milestone.icon;
            document.getElementById('milestoneText').textContent = milestone.text;
            document.getElementById('overlay').classList.add('show');
            document.getElementById('milestoneAlert').classList.add('show');
        }

        function closeMilestone() {
            document.getElementById('overlay').classList.remove('show');
            document.getElementById('milestoneAlert').classList.remove('show');
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(remainingSeconds / 60);
            const seconds = remainingSeconds % 60;
            timer.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
        }

        function updateDisplay() {
            document.getElementById('totalSessions').textContent = sessionData.totalSessions;
            document.getElementById('totalMinutes').textContent = sessionData.totalMinutes;
            document.getElementById('streak').textContent = sessionData.streak;
        }

        function checkStreak() {
            const today = new Date().toDateString();
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            
            if (sessionData.lastSessionDate !== today && 
                sessionData.lastSessionDate !== yesterday.toDateString() &&
                sessionData.lastSessionDate !== null) {
                sessionData.streak = 0;
                saveData();
                updateDisplay();
                updateGrowthStage();
            }
        }

        function saveData() {
            localStorage.setItem('meditationData', JSON.stringify(sessionData));
        }

        document.getElementById('resetBtn').addEventListener('click', () => {
            if (confirm('Are you sure you want to reset all your progress? Your forest will return to a seed.')) {
                sessionData = {
                    totalSessions: 0,
                    totalMinutes: 0,
                    streak: 0,
                    lastSessionDate: null
                };
                localStorage.removeItem('meditationData');
                updateDisplay();
                updateGrowthStage();
                instruction.textContent = "Fresh start! Let's plant that seed again.";
            }
        });

        // Initial display
        updateTimerDisplay();
        updateGrowthStage();
    </script>
</body>
</html>
